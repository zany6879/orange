(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-issue-issue"],{"230e":function(t,e,a){"use strict";a.r(e);var r=a("bab6"),n=a.n(r);for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},2546:function(t,e,a){var r=a("866f");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var n=a("4f06").default;n("58c98565",r,!0,{sourceMap:!1,shadowMode:!1})},5395:function(t,e,a){"use strict";a.r(e);var r=a("f4d5"),n=a("230e");for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a("f773");var o,s=a("f0c5"),l=Object(s["a"])(n["default"],r["b"],r["c"],!1,null,"1e33579e",null,!1,r["a"],o);e["default"]=l.exports},"866f":function(t,e,a){var r=a("24fb");e=r(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* uview-ui */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.fabu_sub[data-v-1e33579e]{background-color:#fff;min-height:1000px;margin:0 auto}.fabu_sub .pointer[data-v-1e33579e]{cursor:pointer}.fabu_sub .flex_wrap[data-v-1e33579e]{display:flex;flex-wrap:wrap;flex-direction:row}.fabu_sub .inp[data-v-1e33579e]{height:40px;border:1px solid #ededed;padding:0 10px}.fabu_sub .v_center[data-v-1e33579e]{text-align:center}.fabu_sub .showht[data-v-1e33579e]{width:400px;height:500px}.fabu_sub .form[data-v-1e33579e]{padding:100px;width:500px;margin:0 auto}',""]),t.exports=e},b85c:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var r=n(a("06c5"));function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var a;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=(0,r.default)(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw o}}}}},baa5:function(t,e,a){var r=a("23e7"),n=a("e58c");r({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},bab6:function(t,e,a){"use strict";(function(t){var r=a("4ea4");a("c975"),a("baa5"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var n=r(a("1da1")),i=r(a("b85c")),o=r(a("e8a2")),s={data:function(){return{address:"",duration:0,title:"",mp4url:"",imgUrl:"",vidoeData:{type:"1"},fileList2:[],showHt:!1,label:[],tagList:[],ht:[],htList:[],hj:[],hjList:[]}},watch:{},created:function(){this.getTag(),this.getHj(),this.getHt(""),uni.request({url:"http://api.map.baidu.com/location/ip?ak=ivS19wE24l0n7fsuwGoZ0koTdgjDkzsx&coor=bd09ll",success:function(e){200==e.statusCode&&t.log(e.data.content.address)}})},beforeDestroy:function(){},methods:{submit:function(){var e=this,a=this.mp4url,r=this.imgUrl,n=this.title,s=this.label,l=this.ht,u=this.hj,c=this.duration,d=this.address;if(""==a)return this.$message.error("请上传视频");if(""==r)return this.$message.error("请选择封面图");if(""==n)return this.$message.error("请输入标题");if(t.log(n.length),n.length<3||n.length>30)return this.$message.error("标题5-30字符之间");if(0==s.length)return this.$message.error("请选择标签");t.log(a),t.log(n),t.log(s),t.log(l),t.log(u);var f,p="",h=(0,i.default)(s);try{for(h.s();!(f=h.n()).done;){var g=f.value;p+=g+","}}catch(y){h.e(y)}finally{h.f()}p=p.substring(0,p.lastIndexOf(","));var v,b="",m=(0,i.default)(l);try{for(m.s();!(v=m.n()).done;){var w=v.value;b+=w+","}}catch(y){m.e(y)}finally{m.f()}b=b.substring(0,b.lastIndexOf(","));var x={content:a,contentType:3,cover:r,label:p,title:n,viewType:1,videoDuration:c,address:d,collectionId:u};x.topic=b||"",t.log(x),o.default.api.fabu(x).then((function(t){0==t.code?(e.$message.success("上传成功,审核中"),setTimeout((function(){window.location.reload()}),2e3)):e.$message.error(t.msg)}))},getTag:function(){var t=this;this.tagList=[],o.default.api.getLabel().then((function(e){var a=e.data;t.tagList=a}))},getHt:function(e){var a=this;o.default.api.getTopic({keyword:e}).then((function(e){t.log(e),a.htList=e.data}))},getHj:function(){var e=this,a=uni.getStorageSync("userInfo");if(a&&a.id){var r={userId:a.id};t.log(r),o.default.api.shortvideoscollectionlist(r).then((function(a){if(t.log(a),0==a.code){var r=a.data;e.hjList=r}else e.$message.error(a.msg)}))}},beforeAvatarUpload:function(e){t.log(e);var a="video/mp4"===e.type,r=e.size/1024/1024<200;return a||this.$message.error("上传视频只能是 MP4 格式!"),r||this.$message.error("上传视频大小不能超过 200MB!"),a&&r},getVideo:function(e){var a=this;t.log(e),0==e.code&&(this.mp4url=e.data.url,this.imgUrl=e.data.videoCoverUrl,uni.getVideoInfo({src:e.data.url,success:function(t){a.duration=t.duration}}))},handerlUpLoadVideo:function(e){var a=this;return(0,n.default)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a,r.next=3,o.default.api.uploadFile(e,{type:"video"});case 3:if(n=r.sent,"string"==typeof n&&(n=JSON.parse(n),t.log("************************视频上传的路径************************"),t.log(n)),!n.fail||"0"!=n.fail){r.next=9;break}e={fail:"0"},r.next=14;break;case 9:if(0!=n.code){r.next=13;break}e=n.data.url,r.next=14;break;case 13:throw"上传视频失败";case 14:return r.abrupt("return",e);case 15:case"end":return r.stop()}}),r)})))()},handerlUpLoadImage:function(e){var a=this;return(0,n.default)(regeneratorRuntime.mark((function r(){var n,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=a,uni.showLoading({title:"上传中..."}),-1==e.indexOf("/storage")){r.next=16;break}return r.next=5,o.default.api.uploadFile(e,{type:"picture"});case 5:if(s=r.sent,uni.hideLoading(),"string"==typeof s&&(s=JSON.parse(s)),0!=s.code){r.next=12;break}n=s.data.url,r.next=14;break;case 12:throw i.$refs.notifyRef.notify("上传封面失败",2),"上传封面失败";case 14:r.next=18;break;case 16:uni.hideLoading(),n=e;case 18:return t.log("-----------视频封面---------"),t.log(n),r.abrupt("return",n);case 21:case"end":return r.stop()}}),r)})))()},taggingImage:function(e){return(0,n.default)(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,o.default.api.taggingImage(e,{});case 2:if(r=a.sent,n=JSON.parse(r),t.log(n),0!=n.code){a.next=9;break}return a.abrupt("return",n.data.body.data.tags);case 9:return a.abrupt("return",[]);case 10:case"end":return a.stop()}}),a)})))()},sleImgFromPhone:function(){var e=this;uni.chooseImage({count:1,sourceType:["album"],success:function(a){var r=a.tempFilePaths[0];t.log(r),e.taggingImage(r)}})}}};e.default=s}).call(this,a("5a52")["default"])},f4d5:function(t,e,a){"use strict";var r;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"fabu_sub"},[a("v-uni-view",{staticClass:"form"},[a("v-uni-view",{staticStyle:{width:"400px"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:!0,"before-upload":t.beforeAvatarUpload,"on-success":t.getVideo,data:t.vidoeData,action:"https://www.pklang.com/admin/sys-file/backToCoverFile",multiple:!0}},[t.imgUrl?a("v-uni-image",{attrs:{src:t.imgUrl,mode:" "}}):t._e(),a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传MP4文件，且不超过200M")])],1)],1),a("v-uni-view",{staticStyle:{"margin-top":"20px"}},[a("v-uni-input",{staticClass:"inp",staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"标题(5-30个字)",maxlength:"30"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("v-uni-view",{staticStyle:{margin:"10px 0"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{"multiple-limit":5,filterable:!0,"allow-create":!0,multiple:!0,"default-first-option":!0,placeholder:"请添加话题"},model:{value:t.ht,callback:function(e){t.ht=e},expression:"ht"}},t._l(t.htList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.topic,value:t.topic}})})),1)],1),a("v-uni-view",{},[a("el-select",{staticStyle:{width:"400px"},attrs:{"multiple-limit":5,multiple:!0,placeholder:"请选择标签(必选)"},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},t._l(t.tagList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.label}})})),1)],1),a("v-uni-view",{staticStyle:{margin:"10px 0"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择合集"},model:{value:t.hj,callback:function(e){t.hj=e},expression:"hj"}},t._l(t.hjList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.collectionName,value:t.id}})})),1)],1),a("v-uni-view",{staticStyle:{padding:"20px 0",width:"400px"}},[a("el-button",{staticStyle:{width:"400px"},attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)],1)},i=[]},f773:function(t,e,a){"use strict";var r=a("2546"),n=a.n(r);n.a}}]);